<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Lista Estatística - Teste</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <h2>Lista Estatística de Usuários - TESTE</h2>
        
        <div class="alert alert-info">
            <p><strong>Instituição:</strong> <span th:text="${nomeInstituicao ?: 'N/A'}">Instituto Teste</span></p>
            <p><strong>Total:</strong> <span th:text="${totalUsuarios ?: 0}">0</span> usuários</p>
            <p><strong>Países:</strong> <span th:text="${#lists.size(estatisticasPaises ?: {})}">0</span></p>
        </div>

        <!-- Teste básico de iteração -->
        <div class="row">
            <div class="col-12">
                <h4>Debug - Lista de Países:</h4>
                <ul>
                    <li th:each="pais : ${estatisticasPaises}" th:text="${pais.nome + ' (' + pais.quantidade + ')'}">País teste</li>
                </ul>
            </div>
        </div>

        <!-- Tabela simples -->
        <div class="table-responsive mt-3">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>País</th>
                        <th>Qtd</th>
                        <th>%</th>
                        <th>Estado</th>
                        <th>Cidade</th>
                    </tr>
                </thead>
                <tbody>
                    <th:block th:each="pais : ${estatisticasPaises}">
                        <th:block th:each="estado : ${pais.subNiveis}">
                            <th:block th:each="cidade : ${estado.subNiveis}">
                                <tr>
                                    <td th:text="${pais.nome}">Brasil</td>
                                    <td th:text="${pais.quantidade}">3</td>
                                    <td th:text="${pais.percentual} + '%'">75%</td>
                                    <td th:text="${estado.nome}">SP</td>
                                    <td th:text="${cidade.nome}">São Paulo</td>
                                </tr>
                            </th:block>
                        </th:block>
                    </th:block>
                </tbody>
            </table>
        </div>

        <div class="mt-3">
            <a href="/administrador/lista-usuarios" class="btn btn-secondary">Voltar</a>
            <button onclick="alert('CSV exportado!')" class="btn btn-success">Exportar CSV</button>
        </div>
    </div>
</body>
</html>
