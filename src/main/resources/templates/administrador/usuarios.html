<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <title>Gestão Geral de Usuários</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
  </head>
  <body>
    <div th:replace="fragments/layout_cabecalho :: cabecalho"></div>
    <div class="container mt-4">
      <h2>Gestão Geral de Usuários</h2>
      <table class="table table-bordered table-hover align-middle">
        <thead class="table-light">
          <tr>
            <th>Cod Usuário</th>
            <th>Nome</th>
            <th>Situação</th>
            <th>Nível Acesso</th>
            <th>Ações</th>
          </tr>
        </thead>
        <tbody>
          <tr th:each="usuario : ${usuarios}">
            <td th:text="${usuario.username}">usuario</td>
            <td th:text="${usuario.pessoa?.nomePessoa}">nome</td>
            <td th:text="${usuario.situacaoUsuario}">A</td>
            <td th:text="${usuario.nivelAcessoUsuario}">1</td>
            <td>
              <!-- Ícone Editar Usuário -->
              <a
                th:href="@{'/administrador/usuarios/editar/' + ${usuario.id}}"
                class="btn btn-sm btn-outline-secondary me-1"
                title="Editar Usuário"
              >
                <i class="fa fa-pencil-alt"></i>
              </a>
              <!-- Ícone Editar Autor, só se nivel >= 2 e existe autor -->
              <a
                th:if="${usuario.nivelAcessoUsuario} >= 2 and usuario.autor != null"
                th:href="@{'/administrador/autores/editar/' + ${usuario.autor.id} + '?origem=usuarios'}"
                class="btn btn-sm btn-outline-primary"
                title="Editar Autor"
              >
                <i class="fa fa-pencil-alt"></i>
              </a>
              <!-- Ações existentes -->
              <a
                th:href="@{'/administrador/usuarios/bloquear/' + ${usuario.id}}"
                >Bloquear</a
              >
              |
              <a th:href="@{'/administrador/usuarios/ativar/' + ${usuario.id}}"
                >Ativar</a
              >
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </body>
</html>
