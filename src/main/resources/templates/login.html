<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Login - Agenda Mais</title>
  <link rel="stylesheet" th:href="@{/css/estilo.css}">
</head>
<body>
  <header class="cabecalho">
    <div class="titulo">
      <h1>Agenda Mais</h1>
      <h3>Agendando tudo e mais</h3>
    </div>
    <div class="logo">
      <img src="/images/logo-mistico.svg" alt="Logo" style="height:40px;">
    </div>
  </header>

  <div class="login-container">
    <h2>Login</h2>

    <p th:if="${mensagemErro}" th:text="${mensagemErro}" class="mensagem-erro"></p>

    <form th:action="@{/login}" method="post">
      <label>Usuário:</label>
      <input type="text" name="codUsuario" 
             th:value="${codUsuario}" 
             required minlength="6" maxlength="30" 
             pattern="^[a-zA-Z0-9]+$"/>

      <label>Senha:</label>
      <div class="senha-container">
        <input type="password" id="senha" name="senha" required/>
        <span onclick="toggleSenha()" class="olho">&#128065;</span>
      </div>

      <select name="instituicao" required>
        <option value="">Selecione uma Instituição</option>
        <option th:each="inst : ${instituicoes}" 
                th:value="${inst.id}" 
                th:text="${inst.nomeInstituicao}"
                th:selected="${inst.id == instituicaoSelecionada}"></option>
      </select>

      <button type="submit" style="width:150px; margin:10px auto; display:block;">Entrar</button>
    </form>

    <div class="links">
      <p><a href="/cadastro-usuario">Não tem cadastro?</a></p>
      <p><a href="/alterar-senha">Deseja alterar sua senha?</a></p>
    </div>

    <div class="recuperacao">
      <p>Para recuperar Usuário/Senha, informe seu Email:</p>
      <form th:action="@{/recuperar-login}" method="post">
        <input type="email" name="email" placeholder="seu@email.com" required/>
      <button type="submit" style="width:150px; margin:10px auto; display:block;">Confirmar</button>
      </form>
      <p th:if="${mensagemRecuperacao}" 
         th:text="${mensagemRecuperacao}" 
         class="mensagem-sucesso"></p>
    </div>
  </div>

  <script>
  function toggleSenha() {
    var input = document.getElementById("senha");
    if (input.type === "password") {
      input.type = "text";
    } else {
      input.type = "password";
    }
  }
  </script>
</body>
</html>
