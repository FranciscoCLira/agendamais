<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Meus Vínculos com Sub-Instituições - AgendaMais</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="container-fluid">
      <!-- Cabeçalho -->
      <div class="row bg-primary text-white p-3 mb-4">
        <div class="col-md-6">
          <h4 class="mb-0">
            <i class="fas fa-university me-2"></i>
            <span th:text="${nomeInstituicao}">Nome da Instituição</span>
          </h4>
        </div>
        <div class="col-md-6 text-end">
          <span class="me-3">
            <i class="fas fa-user me-1"></i>
            <span th:text="${nomeUsuario}">usuario</span>
          </span>
          <span>
            <i class="fas fa-id-badge me-1"></i>
            <span th:text="${nomePessoa}">Nome da Pessoa</span>
          </span>
        </div>
      </div>

      <!-- Mensagens -->
      <div
        th:if="${mensagemSucesso}"
        class="alert alert-success alert-dismissible fade show"
        role="alert"
      >
        <i class="fas fa-check-circle me-2"></i>
        <span th:text="${mensagemSucesso}"></span>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="alert"
        ></button>
      </div>

      <div
        th:if="${mensagemErro}"
        class="alert alert-danger alert-dismissible fade show"
        role="alert"
      >
        <i class="fas fa-exclamation-triangle me-2"></i>
        <span th:text="${mensagemErro}"></span>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="alert"
        ></button>
      </div>

      <!-- Título da Página -->
      <div class="row mb-4">
        <div class="col-12">
          <h2>
            <i class="fas fa-link me-2 text-primary"></i>
            Meus Vínculos com Sub-Instituições
          </h2>
          <p class="text-muted">
            Gerencie seus vínculos com sub-instituições. Adicione, edite ou remova vínculos conforme necessário.
          </p>
        </div>
      </div>

      <!-- Vínculos Diretos com Instituições -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="card">
            <div class="card-header bg-light">
              <h5 class="mb-0">
                <i class="fas fa-university me-2"></i>
                Vínculos Diretos com Instituições
              </h5>
            </div>
            <div class="card-body">
              <div
                th:if="${#lists.isEmpty(vinculosInstituicao)}"
                class="text-center text-muted py-4"
              >
                <i class="fas fa-info-circle fa-2x mb-3"></i>
                <p>Você não possui vínculos diretos com instituições.</p>
              </div>

              <div
                th:if="${!#lists.isEmpty(vinculosInstituicao)}"
                class="table-responsive"
              >
                <table class="table table-striped">
                  <thead>
                    <tr>
                      <th>Instituição</th>
                      <th>Identificação</th>
                      <th>Data de Afiliação</th>
                      <th>Última Atualização</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr th:each="vinculo : ${vinculosInstituicao}">
                      <td>
                        <strong
                          th:text="${vinculo.instituicao.nomeInstituicao}"
                        ></strong>
                      </td>
                      <td>
                        <span
                          th:text="${vinculo.identificacaoPessoaInstituicao ?: 'Não informado'}"
                          class="badge bg-secondary"
                        ></span>
                      </td>
                      <td>
                        <span
                          th:text="${vinculo.dataAfiliacao != null ? #temporals.format(vinculo.dataAfiliacao, 'dd/MM/yyyy') : 'Não informado'}"
                        ></span>
                      </td>
                      <td>
                        <span
                          th:text="${vinculo.dataUltimaAtualizacao != null ? #temporals.format(vinculo.dataUltimaAtualizacao, 'dd/MM/yyyy') : 'Não informado'}"
                        ></span>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Vínculos com Subinstituições -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="card">
            <div class="card-header bg-light">
              <h5 class="mb-0">
                <i class="fas fa-sitemap me-2"></i>
                Vínculos com Subinstituições
              </h5>
            </div>
            <div class="card-body">
              <div
                th:if="${#lists.isEmpty(vinculosSubInstituicao)}"
                class="text-center text-muted py-4"
              >
                <i class="fas fa-info-circle fa-2x mb-3"></i>
                <p>Você não possui vínculos com subinstituições.</p>
              </div>

              <div
                th:if="${!#lists.isEmpty(vinculosSubInstituicao)}"
                class="table-responsive"
              >
                <table class="table table-striped">
                  <thead>
                    <tr>
                      <th>Instituição</th>
                      <th>Subinstituição</th>
                      <th>Identificação</th>
                      <th>Data de Afiliação</th>
                      <th>Última Atualização</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr th:each="vinculo : ${vinculosSubInstituicao}">
                      <td>
                        <strong
                          th:text="${vinculo.instituicao.nomeInstituicao}"
                        ></strong>
                      </td>
                      <td>
                        <span
                          th:text="${vinculo.subInstituicao.nomeSubInstituicao}"
                          class="badge bg-info text-dark"
                        ></span>
                      </td>
                      <td>
                        <span
                          th:text="${vinculo.identificacaoPessoaSubInstituicao ?: 'Não informado'}"
                          class="badge bg-secondary"
                        ></span>
                      </td>
                      <td>
                        <span
                          th:text="${vinculo.dataAfiliacao != null ? #temporals.format(vinculo.dataAfiliacao, 'dd/MM/yyyy') : 'Não informado'}"
                        ></span>
                      </td>
                      <td>
                        <span
                          th:text="${vinculo.dataUltimaAtualizacao != null ? #temporals.format(vinculo.dataUltimaAtualizacao, 'dd/MM/yyyy') : 'Não informado'}"
                        ></span>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Vínculos de Acesso (Usuário-Instituição) -->
      <div class="row mb-4">
        <div class="col-12">
          <div class="card">
            <div class="card-header bg-light">
              <h5 class="mb-0">
                <i class="fas fa-key me-2"></i>
                Vínculos de Acesso (Níveis de Usuário)
              </h5>
            </div>
            <div class="card-body">
              <div
                th:if="${#lists.isEmpty(vinculosUsuario)}"
                class="text-center text-muted py-4"
              >
                <i class="fas fa-info-circle fa-2x mb-3"></i>
                <p>Você não possui vínculos de acesso com instituições.</p>
              </div>

              <div
                th:if="${!#lists.isEmpty(vinculosUsuario)}"
                class="table-responsive"
              >
                <table class="table table-striped">
                  <thead>
                    <tr>
                      <th>Instituição</th>
                      <th>Nível de Acesso</th>
                      <th>Situação</th>
                      <th>Status</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr th:each="vinculo : ${vinculosUsuario}">
                      <td>
                        <strong
                          th:text="${vinculo.instituicao.nomeInstituicao}"
                        ></strong>
                      </td>
                      <td>
                        <span
                          th:switch="${vinculo.nivelAcessoUsuarioInstituicao}"
                          class="badge"
                        >
                          <span th:case="1" class="badge bg-success"
                            >1 - Participante</span
                          >
                          <span th:case="2" class="badge bg-info"
                            >2 - Autor</span
                          >
                          <span th:case="5" class="badge bg-warning text-dark"
                            >5 - Administrador</span
                          >
                          <span th:case="9" class="badge bg-danger"
                            >9 - SuperUsuário</span
                          >
                          <span
                            th:case="*"
                            class="badge bg-secondary"
                            th:text="${vinculo.nivelAcessoUsuarioInstituicao}"
                          ></span>
                        </span>
                      </td>
                      <td>
                        <span
                          th:switch="${vinculo.sitAcessoUsuarioInstituicao}"
                          class="badge"
                        >
                          <span th:case="'A'" class="badge bg-success"
                            >Ativo</span
                          >
                          <span th:case="'B'" class="badge bg-warning text-dark"
                            >Bloqueado</span
                          >
                          <span th:case="'C'" class="badge bg-danger"
                            >Cancelado</span
                          >
                          <span
                            th:case="*"
                            class="badge bg-secondary"
                            th:text="${vinculo.sitAcessoUsuarioInstituicao}"
                          ></span>
                        </span>
                      </td>
                      <td>
                        <span
                          th:if="${vinculo.sitAcessoUsuarioInstituicao == 'A'}"
                          class="text-success"
                        >
                          <i class="fas fa-check-circle me-1"></i>Ativo
                        </span>
                        <span
                          th:if="${vinculo.sitAcessoUsuarioInstituicao != 'A'}"
                          class="text-danger"
                        >
                          <i class="fas fa-times-circle me-1"></i>Inativo
                        </span>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Botões de Ação -->
      <div class="row mb-4">
        <div class="col-12 d-flex justify-content-between">
          <a href="javascript:history.back()" class="btn btn-secondary">
            <i class="fas fa-arrow-left me-2"></i>Voltar
          </a>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
